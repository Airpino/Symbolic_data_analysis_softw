<!DOCTYPE html>
<html lang="en"><head>
<script src="05_day2_Software_for_multivariate_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_day2_Software_for_multivariate_files/libs/quarto-html/tabby.min.js"></script>
<script src="05_day2_Software_for_multivariate_files/libs/quarto-html/popper.min.js"></script>
<script src="05_day2_Software_for_multivariate_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="05_day2_Software_for_multivariate_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_day2_Software_for_multivariate_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="05_day2_Software_for_multivariate_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="05_day2_Software_for_multivariate_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.554">

  <meta name="author" content="A. Irpino, R. Verde ESTP Cologne 14-16 May 2024">
  <title>Software for multivariade regression of Distributional SD</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="05_day2_Software_for_multivariate_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="05_day2_Software_for_multivariate_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #f07178; background-color: #2a0f15; font-weight: bold; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #00e0e0; } /* Attribute */
    code span.bn { color: #d4d0ab; } /* BaseN */
    code span.bu { color: #abe338; } /* BuiltIn */
    code span.cf { color: #ffa07a; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffd700; } /* Constant */
    code span.co { color: #f8f8f2; font-style: italic; } /* Comment */
    code span.cv { color: #ffd700; } /* CommentVar */
    code span.do { color: #f8f8f2; } /* Documentation */
    code span.dt { color: #ffa07a; } /* DataType */
    code span.dv { color: #d4d0ab; } /* DecVal */
    code span.er { color: #f07178; text-decoration: underline; } /* Error */
    code span.ex { color: #00e0e0; font-weight: bold; } /* Extension */
    code span.fl { color: #d4d0ab; } /* Float */
    code span.fu { color: #ffa07a; } /* Function */
    code span.im { color: #abe338; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; font-weight: bold; } /* Keyword */
    code span.op { color: #ffa07a; } /* Operator */
    code span.ot { color: #00e0e0; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.re { color: #00e0e0; background-color: #f8f8f2; } /* RegionMarker */
    code span.sc { color: #abe338; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #00e0e0; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #dcc6e0; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="05_day2_Software_for_multivariate_files/libs/revealjs/dist/theme/quarto.css">
  <link href="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="white" data-background-image="images/main.svg" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Software for multivariade regression of Distributional SD</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
A. Irpino, R. Verde<br>ESTP Cologne 14-16 May 2024 
</div>
</div>
</div>

</section>
<section id="regression-models" class="title-slide slide level1 center">
<h1>Regression models</h1>
<p>This is an <a href="http://rmarkdown.rstudio.com">R Markdown</a> presentation showing an application of the two-components regression model <span class="citation" data-cites="Irp_reg_15">(<a href="#/references" role="doc-biblioref" onclick="">A. Irpino and Verde 2015</a>)</span> on the <code>OzoneFull</code> dataset which is available in the <code>HistDAWass</code> package. We used the <code>HistDAWass</code> package and the therein build functions for the regression analysis.</p>
</section>

<section id="install-and-load-the-package" class="title-slide slide level1 center">
<h1>Install and load the package</h1>
<p>For installing and loading the package in your environment launch the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="do">## if not installed in your environment</span></span>
<span id="cb1-2"><a href=""></a><span class="co">#  install.packages("HistDAWass")</span></span>
<span id="cb1-3"><a href=""></a><span class="fu">library</span>(HistDAWass) <span class="co">#load the package</span></span>
<span id="cb1-4"><a href=""></a><span class="co">#other useful packages</span></span>
<span id="cb1-5"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href=""></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-7"><a href=""></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

<section>
<section id="data-description" class="title-slide slide level1 center">
<h1>Data description</h1>
<p>The <code>OzoneFull</code> dataset is a <code>MatH</code> object, namely, a table of histogram-valued data, representing aggregate raw data downloaded from the Clean Air Status and Trends Network (CASTNET) (<a href="http://java.epa.gov/castnet/%7D,">&lt;http://java.epa.gov/castnet/&gt;</a>), an air-quality monitoring network of the United States, designed to provide data to assess trends in air quality, atmospheric deposition and ecological effects due to changes in air pollutant emissions.</p>
</section>
<section class="slide level2">

<p>We selected data on the ozone concentration in 78 USA sites among those depicted in Fig for which the monitored data were complete (i.e., without missing values for each of the selected characteristics).</p>

<img data-src="figures/site_map_ozone.png" style="width:40.0%" class="r-stretch quarto-figure-center"><p class="caption">CASTNET network sites map</p></section>
<section class="slide level2">

<p>Ozone is a gas that can cause respiratory diseases. In the literature, several studies reported evidence of the relation between the ozone concentration level and temperature, wind speed and the solar radiation (see, for example,<span class="citation" data-cites="Duenas2002">(<a href="#/references" role="doc-biblioref" onclick="">Dueñas et al. 2002</a>)</span>).</p>
<p>Given the distribution of <em>temperature</em> (<span class="math inline">\(X_{1}\)</span>) (degrees Celsius), the distribution of <em>solar radiation</em> (<span class="math inline">\(X_{2}\)</span>) (Watts per square meter) and the distribution of <em>wind speed</em> (<span class="math inline">\(X_{3}\)</span>) (meters per second), the main objective is to predict the distribution of <em>ozone concentration</em> (<span class="math inline">\(Y\)</span>) (Particles per billion) using a linear model. CASTNET collects hourly data and, as the period of observation, we chose the summer season of 2010 and the central hours of the days (10 a.m.–5 p.m.).</p>
</section>
<section class="slide level2">

<p>We collected the histograms of the values of each site observed for the four variables. The histograms were constructed using 100 equi-frequent bins, namely, we have bins of different widths but of constant frequency. The histogram representation of varying bin-width histograms in not always pleasant, we plot the data using only ten equi-frequent bins. We show the first 5 of 78 sites.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">plot</span>(New_OZ[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])<span class="sc">+</span><span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/HIST_MAT_PLOT-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="the-data-table" class="slide level2 smaller">
<h2>The data table</h2>
<p>Each cell of the data table contains a histogram. We see the first three rows of the matrix</p>
<div class="cell">
<div class="cell-output-display">
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 20%">
<col style="width: 6%">
<col style="width: 13%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">ST_ID</th>
<th style="text-align: left;">Bin</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">Bin1</th>
<th style="text-align: right;">p1</th>
<th style="text-align: left;">Bin2</th>
<th style="text-align: right;">p2</th>
<th style="text-align: left;">Bin3</th>
<th style="text-align: right;">p3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">8.77-16.62</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">8.45-11.65</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">25.29- 75.88</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.10-0.35</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">16.62-17.54</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">11.65-13.06</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">75.88-108.27</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.35-0.41</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">17.54-18.42</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">13.06-13.83</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">108.27-111.43</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.41-0.50</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">18.42-18.90</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">13.83-14.12</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">111.43-114.09</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.50-0.55</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">65.68-67.78</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">28.87-29.23</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">914.12-933.30</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">3.52-3.79</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I1</td>
<td style="text-align: left;">67.78-89.60</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">29.23-30.18</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">933.30-942.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">3.79-4.48</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">9.00-15.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">9.50- 9.75</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">49.00- 56.16</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.10-0.55</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">15.00-17.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">9.75-10.38</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">56.16- 71.50</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.55-0.80</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">17.00-18.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">10.38-10.60</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">71.50-102.84</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.80-0.80</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">18.00-19.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">10.60-11.24</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">102.84-133.40</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.80-0.90</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">54.24-58.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">29.02-29.60</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">910.00-916.84</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">7.52-8.37</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I2</td>
<td style="text-align: left;">58.00-63.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">29.60-30.70</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">916.84-944.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">8.37-9.60</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">9.25-17.99</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">17.57-20.13</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">52.57- 78.67</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.08-0.26</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">17.99-20.31</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">20.13-20.63</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">78.67-105.48</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.26-0.38</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">20.31-21.41</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">20.63-21.13</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">105.48-116.96</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.38-0.41</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">21.41-22.20</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">21.13-21.61</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">116.96-140.19</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">0.41-0.45</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">…-…</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">62.38-64.11</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">36.10-36.42</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">979.18- 990.02</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">3.77-4.07</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">I3</td>
<td style="text-align: left;">64.11-69.45</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">36.42-37.07</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">990.02-1020.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: left;">4.07-4.81</td>
<td style="text-align: right;">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="basic-wasserstein-based-statistics" class="slide level2">
<h2>Basic Wasserstein-based statistics</h2>
<h3 id="the-frechét-mean-distributions-of-the-the-four-variables">The Frechét mean distributions of the the four variables</h3>
<p>We start computing the Frechét mean of each distributional variable using the <span class="math inline">\(L_2\)</span> Wassertein distance as in <span class="citation" data-cites="IrpVer2015">(<a href="#/references" role="doc-biblioref" onclick="">R. Irpino A.and Verde 2015</a>)</span></p>
<h4 id="ozone">Ozone</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Output shows the first five and the last five bins due to eccesive length 
                 X                 p
Bin_1   [14.789-19.479)              0.01
Bin_2   [19.479-21.567)              0.01
Bin_3   [21.567-22.872)              0.01
Bin_4   [22.872-23.912)              0.01
Bin_5   [23.912-24.894)              0.01
...               ...               ...
Bin_96 [57.865 ; 58.948)              0.01
Bin_97 [58.948 ; 60.278)              0.01
Bin_98 [60.278 ; 61.979)              0.01
Bin_99 [61.979 ; 64.515)              0.01
Bin_100 [64.515 ; 71.095)              0.01

 mean =  41.2147347282052   std  =  9.96802979889176 
 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h4 id="temperature">Temperature</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Output shows the first five and the last five bins due to eccesive length 
                 X                 p
Bin_1   [10.355-12.383)              0.01
Bin_2    [12.383-13.91)              0.01
Bin_3      [13.91-15.1)              0.01
Bin_4     [15.1-15.853)              0.01
Bin_5   [15.853-16.473)              0.01
...               ...               ...
Bin_96 [28.795 ; 29.106)              0.01
Bin_97 [29.106 ; 29.447)              0.01
Bin_98 [29.447 ; 29.888)              0.01
Bin_99 [29.888 ; 30.569)              0.01
Bin_100 [30.569 ; 31.602)              0.01

 mean =  23.2805152974359   std  =  3.76407404885491 
 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h4 id="solar-radiation">Solar Radiation</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Output shows the first five and the last five bins due to eccesive length 
                 X                 p
Bin_1   [54.186-89.738)              0.01
Bin_2   [89.738-123.48)              0.01
Bin_3   [123.48-148.68)              0.01
Bin_4    [148.68-177.1)              0.01
Bin_5    [177.1-202.25)              0.01
...               ...               ...
Bin_96 [926.63 ; 934.72)              0.01
Bin_97 [934.72 ; 943.94)              0.01
Bin_98 [943.94 ; 955.36)              0.01
Bin_99 [955.36 ; 970.49)              0.01
Bin_100 [970.49 ; 997.58)              0.01

 mean =  645.350728000001   std  =  225.781773829828 
 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h4 id="wind-speed">Wind Speed</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Output shows the first five and the last five bins due to eccesive length 
                 X                 p
Bin_1 [0.11386-0.36784)              0.01
Bin_2 [0.36784-0.52206)              0.01
Bin_3 [0.52206-0.62055)              0.01
Bin_4 [0.62055-0.70678)              0.01
Bin_5 [0.70678-0.77491)              0.01
...               ...               ...
Bin_96 [4.3248 ; 4.4692)              0.01
Bin_97 [4.4692 ; 4.6702)              0.01
Bin_98 [4.6702 ; 4.9502)              0.01
Bin_99 [4.9502 ; 5.4696)              0.01
Bin_100 [5.4696 ; 6.5707)              0.01

 mean =  2.34883345512821   std  =  1.09865034695591 
 </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="the-plot-of-the-four-barycenters">The plot of the four barycenters</h3>

<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/Four_baric-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">The mean distributions for each variable</p></section>
<section class="slide level2">

<p>In Table <a href="#/TAB:OZO_summarystat" data-reference-type="ref" data-reference="TAB:OZO_summarystat">[TAB:OZO_summarystat]</a>, we report the main summary statistics for the four histogram variables, while in Fig. <a href="#/Fig: OZO_barycenters" data-reference-type="ref" data-reference="Fig: OZO_barycenters">[Fig: OZO_barycenters]</a>, we provide the four barycenters of the 78 sites for each variable. We note, for example, the different skewness of the barycenters. In general, when the barycenter is skewed, the observed distributions are in general skewed in the same direction. This is not in general true for symmetric barycenters, which can be generated both from left- and right-skewed distributions.</p>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Basic statistics of barycenters</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Std</th>
<th style="text-align: right;">First_Q</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Third_Q</th>
<th style="text-align: right;">Skewness</th>
<th style="text-align: right;">Kurtosis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone</td>
<td style="text-align: right;">41.21</td>
<td style="text-align: right;">9.97</td>
<td style="text-align: right;">34.27</td>
<td style="text-align: right;">41.15</td>
<td style="text-align: right;">48.05</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">2.778</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature</td>
<td style="text-align: right;">23.28</td>
<td style="text-align: right;">3.76</td>
<td style="text-align: right;">21.04</td>
<td style="text-align: right;">23.71</td>
<td style="text-align: right;">25.93</td>
<td style="text-align: right;">-0.596</td>
<td style="text-align: right;">3.393</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solar Radiation</td>
<td style="text-align: right;">645.35</td>
<td style="text-align: right;">225.78</td>
<td style="text-align: right;">496.05</td>
<td style="text-align: right;">701.63</td>
<td style="text-align: right;">826.56</td>
<td style="text-align: right;">-0.715</td>
<td style="text-align: right;">2.580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wind Speed</td>
<td style="text-align: right;">2.35</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: right;">0.649</td>
<td style="text-align: right;">3.456</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p>We show the covariances and correlations of the variables in the next two tables, and the standard deviations of the variables computed according to what is proposed in <span class="citation" data-cites="IrpVer2015">(<a href="#/references" role="doc-biblioref" onclick="">R. Irpino A.and Verde 2015</a>)</span> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Covariance matrix</span></span>
<span id="cb7-2"><a href=""></a>Cov_M<span class="ot">&lt;-</span><span class="fu">WH.var.covar</span>(OzoneFull)</span>
<span id="cb7-3"><a href=""></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(Cov_M,<span class="dv">2</span>), <span class="at">caption=</span><span class="st">"Covariance matrix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<caption>Covariance matrix</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 25%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Ozone.Conc.ppb</th>
<th style="text-align: right;">Temperature.C</th>
<th style="text-align: right;">Solar.Radiation.WattM2</th>
<th style="text-align: right;">Wind.Speed.mSec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone.Conc.ppb</td>
<td style="text-align: right;">90.81</td>
<td style="text-align: right;">9.05</td>
<td style="text-align: right;">690.92</td>
<td style="text-align: right;">5.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature.C</td>
<td style="text-align: right;">9.05</td>
<td style="text-align: right;">14.76</td>
<td style="text-align: right;">197.71</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solar.Radiation.WattM2</td>
<td style="text-align: right;">690.92</td>
<td style="text-align: right;">197.71</td>
<td style="text-align: right;">12866.55</td>
<td style="text-align: right;">65.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wind.Speed.mSec</td>
<td style="text-align: right;">5.03</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">65.47</td>
<td style="text-align: right;">1.73</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Standard deviations</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone.Conc.ppb</td>
<td style="text-align: right;">9.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature.C</td>
<td style="text-align: right;">3.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solar.Radiation.WattM2</td>
<td style="text-align: right;">113.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wind.Speed.mSec</td>
<td style="text-align: right;">1.31</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table>
<caption>Correlation matrix</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 25%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Ozone.Conc.ppb</th>
<th style="text-align: right;">Temperature.C</th>
<th style="text-align: right;">Solar.Radiation.WattM2</th>
<th style="text-align: right;">Wind.Speed.mSec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ozone.Conc.ppb</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.247</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">0.402</td>
</tr>
<tr class="even">
<td style="text-align: left;">Temperature.C</td>
<td style="text-align: right;">0.247</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">0.143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Solar.Radiation.WattM2</td>
<td style="text-align: right;">0.639</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.439</td>
</tr>
<tr class="even">
<td style="text-align: left;">Wind.Speed.mSec</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">0.439</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="two-components-regression-model" class="slide level2 smaller">
<h2>Two-components regression model</h2>
<p>Now we estimate the model</p>
<p><span class="math display">\[
Y=\beta_0+\beta_1\mu_{X_1}+\beta_2\mu_{X_2}+\beta_3\mu_{X_3}+
\gamma_1{X^c_1}+\gamma_2{X^c_2}+\gamma_3{X^c_3}+\varepsilon
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>results<span class="ot">&lt;-</span><span class="fu">WH.regression.two.components</span>(OzoneFull,<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb8-2"><a href=""></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">data.frame</span>(<span class="at">Coeff.est.=</span><span class="fu">round</span>(results,<span class="dv">3</span>)),</span>
<span id="cb8-3"><a href=""></a>             <span class="at">caption=</span><span class="st">"regression parameters"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table>
<caption>regression parameters</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Coeff.est.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(AV_Intercept)</td>
<td style="text-align: right;">2.927</td>
</tr>
<tr class="even">
<td style="text-align: left;">AV_Temperature.C</td>
<td style="text-align: right;">-0.346</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AV_Solar.Radiation.WattM2</td>
<td style="text-align: right;">0.070</td>
</tr>
<tr class="even">
<td style="text-align: left;">AV_Wind.Speed.mSec</td>
<td style="text-align: right;">0.395</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CEN_Temperature.C</td>
<td style="text-align: right;">0.915</td>
</tr>
<tr class="even">
<td style="text-align: left;">CEN_Solar.Radiation.WattM2</td>
<td style="text-align: right;">0.018</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CEN_Wind.Speed.mSec</td>
<td style="text-align: right;">1.887</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="slide level2">

<p>We compute the goodness of fit statistics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="co"># we compute the expected distributions</span></span>
<span id="cb9-2"><a href=""></a>expected<span class="ot">&lt;-</span><span class="fu">WH.regression.two.components.predict</span>(OzoneFull[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],results)</span>
<span id="cb9-3"><a href=""></a></span>
<span id="cb9-4"><a href=""></a><span class="co"># we compute the GOF measures</span></span>
<span id="cb9-5"><a href=""></a></span>
<span id="cb9-6"><a href=""></a>GOFS<span class="ot">&lt;-</span> <span class="fu">WH.regression.GOF</span>(OzoneFull[,<span class="dv">1</span>],expected)</span>
<span id="cb9-7"><a href=""></a>GOFS</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$RMSE_W
[1] 7.000022

$OMEGA
[1] 0.7423388

$PSEUDOR2
$PSEUDOR2$index
[1] 0.4604191

$PSEUDOR2$details
      TotSSQ        SSQ.R        SSQ.E         Bias    SSQ.R.rel    SSQ.E.rel 
7083.3190671 4070.7089580 3822.0239212 -809.4138121    0.5746895    0.5395809 
SSQ.bias.rel 
  -0.1142704 </code></pre>
</div>
</div>
</section>
<section id="bootstrap-confidence-intervals-for-the-model-parameters" class="slide level2 smaller">
<h2>Bootstrap confidence intervals for the model parameters</h2>
<p>We perform a bootstrap estimates of the confidence intervals of the parameters using 1,000 replications</p>
<div class="cell">
<div class="cell-output-display">
<table>
<caption>Bootstrap results</caption>
<colgroup>
<col style="width: 36%">
<col style="width: 14%">
<col style="width: 20%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">model.est.</th>
<th style="text-align: right;">boot.mean.est.</th>
<th style="text-align: right;">bias</th>
<th style="text-align: right;">q.2.5</th>
<th style="text-align: right;">q.97.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(AV_Intercept)</td>
<td style="text-align: right;">2.927</td>
<td style="text-align: right;">3.209</td>
<td style="text-align: right;">-0.282</td>
<td style="text-align: right;">-11.587</td>
<td style="text-align: right;">15.136</td>
</tr>
<tr class="even">
<td style="text-align: left;">AV_Temperature.C</td>
<td style="text-align: right;">-0.346</td>
<td style="text-align: right;">-0.352</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-0.813</td>
<td style="text-align: right;">0.179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AV_Solar.Radiation.WattM2</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.090</td>
</tr>
<tr class="even">
<td style="text-align: left;">AV_Wind.Speed.mSec</td>
<td style="text-align: right;">0.395</td>
<td style="text-align: right;">0.378</td>
<td style="text-align: right;">0.017</td>
<td style="text-align: right;">-1.301</td>
<td style="text-align: right;">1.942</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CEN_Temperature.C</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">1.371</td>
</tr>
<tr class="even">
<td style="text-align: left;">CEN_Solar.Radiation.WattM2</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">0.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CEN_Wind.Speed.mSec</td>
<td style="text-align: right;">1.887</td>
<td style="text-align: right;">1.973</td>
<td style="text-align: right;">-0.087</td>
<td style="text-align: right;">1.044</td>
<td style="text-align: right;">3.118</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="slide level2">

<p>Reading the bootstrap results, we may assert that the ozone concentration distribution of a site depends on the mean <em>solar radiation</em>, where for each <span class="math inline">\(\Delta Watt/m^{2}\)</span> a <span class="math inline">\(0.070\;(ppb)\)</span> variation of the <em>ozone concentration</em> mean level is expected, while in general we cannot say that the mean levels of <em>temperature</em> and <em>wind speed</em> induce a significant variation of the <em>ozone concentration level</em>(<span class="math inline">\(95\%\)</span> bootstrap confidence intervals include the zero). Furthermore, the variability of the <em>ozone concentration</em> is almost the same of the <em>temperature</em>(<span class="math inline">\(0.928\)</span>); a unitary variation in the variability of the <em>solar radiation</em> induces a variation of <span class="math inline">\(0.018\;(ppb)\)</span> and a variation in the variability of the <em>wind speed</em> causes an increase in the variability of <span class="math inline">\(1.958\;(ppb)\)</span>.</p>
</section>
<section id="residual-analysis" class="slide level2">
<h2>Residual analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>Res<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="fu">length</span>(expected<span class="sc">@</span>M[<span class="dv">1</span>,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x))</span>
<span id="cb11-2"><a href=""></a>C<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="fu">length</span>(expected<span class="sc">@</span>M[<span class="dv">1</span>,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-3"><a href=""></a>R<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="fu">length</span>(expected<span class="sc">@</span>M[<span class="dv">1</span>,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb11-4"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb11-5"><a href=""></a>  Res[i,]<span class="ot">&lt;-</span>expected<span class="sc">@</span>M[i,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x<span class="sc">-</span>OzoneFull<span class="sc">@</span>M[i,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x</span>
<span id="cb11-6"><a href=""></a>  R[i,]<span class="ot">&lt;-</span><span class="fu">diff</span>(expected<span class="sc">@</span>M[i,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x<span class="sc">-</span>OzoneFull<span class="sc">@</span>M[i,<span class="dv">1</span>][[<span class="dv">1</span>]]<span class="sc">@</span>x)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb11-7"><a href=""></a>  C[i,]<span class="ot">&lt;-</span>(Res[i,<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(Res[i,])<span class="sc">-</span><span class="dv">1</span>)]<span class="sc">+</span></span>
<span id="cb11-8"><a href=""></a>            Res[i,<span class="dv">2</span><span class="sc">:</span>(<span class="fu">length</span>(Res[i,]))])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb11-9"><a href=""></a>}</span>
<span id="cb11-10"><a href=""></a></span>
<span id="cb11-11"><a href=""></a>SDRES<span class="ot">&lt;-</span><span class="fu">sqrt</span>((<span class="fl">0.01</span><span class="sc">*</span>(<span class="fu">sum</span>(C<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">sum</span>(<span class="fu">colMeans</span>(C)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb11-12"><a href=""></a>                    <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span><span class="sc">*</span>(<span class="fu">sum</span>(R<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">sum</span>(<span class="fu">colMeans</span>(R)<span class="sc">^</span><span class="dv">2</span>))))<span class="sc">/</span>n)</span>
<span id="cb11-13"><a href=""></a></span>
<span id="cb11-14"><a href=""></a>Res_st<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n),Res<span class="sc">/</span>SDRES)</span>
<span id="cb11-15"><a href=""></a>Res<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">ID=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n),Res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>MyL<span class="ot">&lt;-</span>Res <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>ID,<span class="at">names_to =</span> <span class="st">"var"</span>,<span class="at">values_to =</span> <span class="st">"val"</span>)<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Q=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">78</span>)<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb12-2"><a href=""></a>MyL_st<span class="ot">&lt;-</span>Res_st <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>ID,<span class="at">names_to =</span> <span class="st">"var"</span>,<span class="at">values_to =</span> <span class="st">"val"</span>)<span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Q=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>,<span class="dv">78</span>)<span class="sc">/</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<h4 id="plot-of-standardized-residual-functions">Plot of standardized residual functions</h4>

<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="boxplot-of-residual-functions" class="slide level2">
<h2>Boxplot of residual functions</h2>

<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="observe-that" class="slide level2">
<h2>Observe that:</h2>
<p>In general the standardized error functions are inside the <span class="math inline">\(\pm2\sigma\)</span> band. Looking at the point-wise boxplots, we see that in general the average error function is close to the zero line, suggesting that the process generating the error functions has zero mean. Also the boxplots seem to suggest that the process have constant variance in <span class="math inline">\([0;1]\)</span>.</p>
<p>We note that stations <span class="math inline">\(I23\)</span>, <span class="math inline">\(I41\)</span>, and <span class="math inline">\(I69\)</span> present error functions which have the most part of the values far more than <span class="math inline">\(\pm2\sigma\)</span>.</p>
</section>
<section class="slide level2">

<h3 id="worst-and-best-predictions">Worst and best predictions</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>HistDAWass<span class="sc">::</span><span class="fu">plotPredVsObs</span>(expected[<span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">61</span>,<span class="dv">37</span>,<span class="dv">66</span>,<span class="dv">63</span>,<span class="dv">73</span>),],OzoneFull[<span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">61</span>,<span class="dv">37</span>,<span class="dv">66</span>,<span class="dv">63</span>,<span class="dv">73</span>),<span class="dv">1</span>],<span class="at">type=</span><span class="st">"DENS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/unnamed-chunk-8-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section class="slide level2">

<h3 id="pointwise-testing-for-normality">Pointwise testing for normality</h3>
<p>We compute the Shapiro test for each percentile with and without outliers.</p>

<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section class="slide level2">


<img data-src="05_day2_Software_for_multivariate_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>It seems that removing the outliers the process is almost Gaussian after <span class="math inline">\(p=0.07\)</span>.</p>
<!-- ### Best and worst predictions -->
<!-- ```{r, caption="Worst and best predictions"} -->
<!-- tmp_e<-expected[c(22,61,37,66,63,73),] -->
<!-- tmp_o<-OzoneFull[c(22,61,37,66,63,73),1] -->
<!-- for (i in 1:6){ -->
<!--    tmp_e@M[i,1][[1]]@x<-tmp_e@M[i,1][[1]]@x[seq(1,101,by=10)] -->
<!--     tmp_e@M[i,1][[1]]@p<-tmp_e@M[i,1][[1]]@p[seq(1,101,by=10)] -->
<!--        tmp_o@M[i,1][[1]]@x<-tmp_o@M[i,1][[1]]@x[seq(1,101,by=10)] -->
<!--     tmp_o@M[i,1][[1]]@p<-tmp_o@M[i,1][[1]]@p[seq(1,101,by=10)] -->
<!-- } -->
<!-- HistDAWass::plotPredVsObs(tmp_e,tmp_o) -->
<!-- ``` -->
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<ul>
<li>The two-components regression for distributional data shows interesting patterns related to the position and the internal variability of distributional data.</li>
<li>If data are intervals, we can consider a interval as a uniform distributions or a one-bin histograms.</li>
<li>You can use histograms with different binning thanks to Wasserstein.</li>
<li>If the domain of distribution is discrete, it is easy to generalize the method (Actually we are developing that).</li>
<li>The use of scalar parameters helps interpretation, but the final fitting can be biased. We are developing some <em>correction</em> tools for that.</li>
</ul>
</section></section>
<section id="references" class="title-slide slide level1 smaller scrollable">
<h1>References</h1>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">
<p>Software for multivariade regression of Distributional SD, ESTP Cologne 14-16 May 2024</p>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Duenas2002" class="csl-entry" role="listitem">
Dueñas, C., M. C. Fernández, S. Cañete, J. Carretero, and E. Liger. 2002. <span>“Assessment of Ozone Variations and Meteorological Effects in an Urban Area in the Mediterranean Coast.”</span> <em>Science of The Total Environment</em> 299 (1-3): 97–113. <a href="https://doi.org/10.1016/s0048-9697(02)00251-6">https://doi.org/10.1016/s0048-9697(02)00251-6</a>.
</div>
<div id="ref-Irp_reg_15" class="csl-entry" role="listitem">
Irpino, Antonio, and Rosanna Verde. 2015. <span>“Linear Regression for Numeric Symbolic Variables: A Least Squares Approach Based on Wasserstein Distance.”</span> <em>Advances in Data Analysis and Classification</em> 9 (1): 81–106.
</div>
<div id="ref-IrpVer2015" class="csl-entry" role="listitem">
Irpino, R., A.and Verde. 2015. <span>“Basic Statistics for Distributional Symbolic Variables: A New Metric-Based Approach.”</span> <em>Advances in Data Analysis and Classification</em> 9 (2): 143–75. <a href="https://doi.org/10.1007/s11634-014-0176-4">https://doi.org/10.1007/s11634-014-0176-4</a>.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="05_day2_Software_for_multivariate_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 500,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>